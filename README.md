# UDFS

### **脱敏算法**



| **脱敏技术**                                   | **实现函数**                                                    | **描述**                                                      | **参数说明**                                                                              | **举例**                                                                                                          |
|--------------------------------------------|-------------------------------------------------------------|-------------------------------------------------------------|---------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|
| **规整**                                     | regular(int value,int f1,int f2[,int f3,int f4])            | 区间规整，将数据分成不同的级别，支持三级、五级                            | 输入两个参数分为三级（高/中/低）<br/>输入四个参数为五级（一级/.../五级）<br/>分级的参数只支持整型                                     | regular(22,10,30)->中 22为中级<br/>regular(22,10,20,30,40)->三级 22为三级                                                    |
| **取整**                                     | number_floor(int num,int place)                             | 数字按位取整                                                      | num表示待取整的数字<br/>place表示取整的位数                                                              | number_floor(123456,3)->123000                                                                                  |
|                                            | date_floor(Date date[TimeStamp timeNum],range)              | 日期取整                                                        | 支持输入的日期格式为Date或TimeStamp<br/>range表示取整的粒度<br/>可选择以下关键字：year/month/day/hour/minute/second | date_floor('2021-08-16','year')->2021-01-01                                                                     |                                                              |
| **截断**                                     | block_front(string data[,char a])                           | 特殊符号前截断（针对首次出现该字符）                                    | data为待处理的字符串<br/>默认特殊字符"@"<br/>可自定义符号                                                          | 例如，123@163.com→@com                                                                                             |
|                                            | block_back(string data[,char a])                            | 特殊符号后截断（针对首次出现该字符）                                          | data为待处理的字符串<br/>默认特殊字符"@"<br/>可自定义符号                                                         | 例如123@345@163.com→123@                                                                                          |                                                              |
|                                            | keep_front(string data,int M)                                  | 保留前M位，其余截断                                                  | 输入待处理字符串data以及保留位数M                                                                   | 例如M=3，021-1234567→021                                                                                           |                                                              |
|                                            | keep_back(string data,int N)                                   | 保留后N位，其余截断                                                  | 输入待处理字符串data以及保留位数N                                                                   | 例如M=3，021-1234567→567                                                                                           |                                                              |
| **字符位移**                                   | shiftleft(int a,int b)                                      | 将整型数字a向左位移b位                                                | a表示待处理的数字，b表示移动的位数                                                                    | 例如a=2,b=1,2转换成二进制为0010，向左移动一位为0100=4                                                                            |
|                                            | shiftright(int a,int b)                                       | 将整型数字a向左位移b位                                                | a表示待处理的数字<br/>b表示移动的位数                                                                    | 例如a=4,b=1,2转换成二进制为0100，向右移动一位为0010=2                                                                            |                                                              |
|                                            | shiftrightunsigned(int a,int b)                               | 按位无符号右移                                                     | a表示待处理的数字<br/>b表示移动的位数                                                                    | 例如a=4,b=1,2转换成二进制为0100，向右移动一位为0010=2                                                                            |                                                              |
| **掩码屏蔽**  **(不指定掩码长度)**             | mask(data_string[, mask_string], pre_length[, post_length]) | 保留前n后m                                                      | n、m、遮盖字符（默认为*）                                                                        | 例如n=1，m=2，浙江省杭州市西湖区胡同口→浙*********同口                                                                             |
|                                            | keep_from(string data,int x,int y)                            | 保留自x至y                                                      | x、y、遮盖字符（默认为*）                                                                        | 例如x=1，y=2，浙江省杭州市西湖区胡同口→浙江**********                                                                             |                                                              |
|                                            | cover(String data,int n,int m[char a])                        | 遮盖前n后m                                                      | n、m、遮盖字符（默认为*）                                                                        | 例如n=1，m=2，浙江省杭州市西湖区胡同口→*江省杭州市西湖区胡**                                                                             |                                                              |
|                                            | mask_from(string data,int x,int y)                            | 遮盖自x至y                                                      | x、y、遮盖字符（默认为*）                                                                        | 例如x=1，y=2，浙江省杭州市西湖区胡同口→**省杭州市西湖区胡同口                                                                             |                                                              |
|                                            | mask_front(string data[,char a])                              | 特殊字符前遮盖（针对首次出现该字符）                                          | 自定义特殊字符a（默认为“@” ）<br/>遮盖字符（默认为*）                                                          | 例如123@[456@163.com](mailto:456@163.com)→***@[456@163.com](mailto:456@163.com)                                   |                                                              |
|                                            | mask_back(string data[,char a])                               | 特殊字符后遮盖（针对首次出现该字符）                                          | 自定义特殊字符a（默认为“@” ）<br/>遮盖字符（默认为*）                                                          | 例如123@456@163.com→123@***********                                                                               |                                                              |
|                                            | mask_specify(string data,int front,int back,int middle[,char a]) | 保留前n后m                                                      | n、m、遮盖字符（默认为*）<br/>遮盖字符长度L                                                                | 例如n=1，m=2，L=3浙江省杭州市西湖区胡同口→浙***同口                                                                                |                                                              |
| **掩码屏蔽**  **(指定掩码长度)**                     | keep_from_sl(string data,int x,int y,int l[,char a])        | 保留自x至y                                                      | x、y、遮盖字符（默认为*）<br/>遮盖字符长度L                                                                | 例如x=2，y=3，L=3，浙江省杭州市西湖区胡同口→***江省***                                                                             |
|                                            | cover_sl(string data,int n,int m,int l[,char a])              | 遮盖前n后m                                                      | n、m、遮盖字符（默认为*）<br/>遮盖字符长度L                                                                | 例如n=1，m=2，L=3，浙江省杭州市西湖区胡同口→***江省杭州市西湖区胡***                                                                      |                                                              |
|                                            | mask_from_sl(string data,int x,int y,int l[,char a])          | 遮盖自x至y                                                      | x、y、遮盖字符（默认为*）<br/>遮盖字符长度L                                                                | 例如x=2，y=3，L=3，浙江省杭州市西湖区胡同口→浙***杭州市西湖区胡同口                                                                        |                                                              |
|                                            | mask_front_sl(string data,int l[,char a])                     | 特殊字符前遮盖（针对首次出现该字符）                                          | 自定义特殊字符a（默认为“@” ）<br/>遮盖字符（默认为*）<br/>遮盖字符长度L                                                  | 例如特殊符号“@”，L=2，123@[456@163.com](mailto:456@163.com)→**@[456@163.com](mailto:456@163.com)                        |                                                              |
|                                            | mask_back_sl(string data,int l[,char a])                      | 特殊字符后遮盖（针对首次出现该字符）                                          | 自定义特殊字符a（默认为“@” ）<br/>遮盖字符（指定为*<br/>不支持用户指定字符）<br/>遮盖字符长度L                                        | 例如特殊符号“@”，L=2，例如123@456@163.com→123@**                                                                          |                                                              |
| **B64编码**                                  | base64(bin)                                                 | base64编码，将参数从二进制转换为 base 64 字符串                             | 二进制参数                                                                                 |                                                                                                                 |
| **对称加密**                                   | des_encrypt(string value,string key)                        | DES算法加密                                                     | 待加密内容以及加密密钥                                                                           | 输入待加密的data以及加密密钥key（56位），输出加密后的字符串                                                                              |
|                                            | des_decrypt(string buff,string key)                           | DES算法解密                                                     | 密文以及密钥                                                                                | 输入密文buff以及加密密钥key（56位），输出明文                                                                                     |                                                              |
|                                            | triple_des_encrypt(string value,string key)                   | 3DES算法加密                                                    | 待加密内容以及加密密钥                                                                           | 输入待加密的data以及加密密钥key（168位），输出加密后的字符串（经过Base64编码）                                                                 |                                                              |
|                                            | triple_des_decrypt(string value,string key)                   | 3DES算法解密                                                    | 密文以及密钥                                                                                | 输入密文buff以及加密密钥key（168位），输出明文                                                                                    |                                                              |
|                                            | aes_encrypt(input string/binary, key string/binary)           | AES算法加密                                                     | 待加密内容以及加密密钥                                                                           | 输入字符串/二进制待加密数据以及密钥，输出aes加密后的字符串                                                                                 |                                                              |
|                                            | aes_decrypt(input binary, key string/binary)                  | AES算法解密                                                     | 密文以及密钥                                                                                | 输入二进制密文以及密钥，输出明文                                                                                                |                                                              |
|                                            | caesar_cipher(data_string[, shift_value])                     | 凯撒加密                                                        | 待加密内容data，以及偏移量                                                                       | caesar_cipher('012ABC6789', 1)->123BCD7890                                                                      |                                                              |
|                                            | sm4_encrypt(string data,string key)                           | 国密SM4                                                       | 待加密内容data，以及密钥key                                                                     | 输入待加密的data以及加密密钥key（128位），输出加密后的字符串（经过Hex编码）                                                                    |                                                              |
|                                            | sm4_decrypt(string data,string key)                           | 国密SM4                                                       | 经过加密的密文，以及密钥                                                                          | 输入经过SM4加密的密文以及密钥（128位），输出解密的明文                                                                                  |                                                              |
| **常量替换**                                   | hide(int data,int m)                                        | 常量替换                                                        | 支持int，string以及double类型数据替换                                                            | 12->0 hello->hi 12.34->12.0                                                                                     |
|                                            | replace(string str,string search,string rep)                  | 关键字替换将A替换成B                                                 | 将字符串'str'中的'search'部分替换成'rep'                                                         | 例如，原始数据为abcdefgbcdefgkjkoij，“关键字”配置为“bcde”，“替换字符串”配置为12，则“脱敏结果”显示为a12fg12fgkjkoij                               |                                                              |
| **哈希脱敏**                                 | md5(string)                                                 | 哈希脱敏-MD5                                                    | 输入待处理的字符串即可                                                                           | md5("a")->0cc175b9c0f1b6a831c399e269772661                                                                      |
|                                            | sha1(str or bin)                                              | 哈希脱敏-SHA1                                                   | 输入待处理的字符串即可                                                                           | sha1('ABC')->'3c01bdbb26f358bab27f267924aa2c9a03fcfdb8'                                                         |                                                              |
|                                            | sha2(string/binary, len)                                      | 哈希脱敏-SHA2                                                   | len表示加密位数，可以选择256或512                                                                 | sha2('ABC',  256)->'b5d4045c3f466fa91fe2cc6abe79232a1a57cdf104f7a26e716e0a1e2789df78'                           |                                                              |
|                                            | sm3(string data[byte[] data])                                 | 国密哈希SM3                                                     | data表示待处理的数据<br/>支持string类型以及byte[]类型                                                     | sm3('hello world')->'RPAGHmn6b9/CkMSUZUoF3AwFPaflxSuE75Op1n0//4g='                                              |                                                              |
|                                            | hmac(string data,string key)                                  | HMAC哈希算法                                                    | data表示待处理的数据<br/>key表示用于认证密钥<br/>同时支持string类型以及byte[]类型                                       | hmac('hello  world','R/EF98s2xof7m16m+3b4n/0DDZbbTlDERdedJqfhP94=')->'GbuH7HC/dkpCDp0lYJjgpDcfB2hKwdwVdJAE/1ZX89Y=' |                                                              |
| **随机替换**                                | random_str(int L)                                           | 生成指定长度L的随机字符串替换原字段                                          | L表示随机字符串长度                                                                            | 例如L=5，alice→Wzf_v                                                                                               |
|                                            | random(x,y,[seed])                                            | 返回一个介于x和y之间的伪随机数替换原字段                                       | x,y表示随机数的上界和下界                                                                        | random(10,50)->39                                                                                               |                                                              |
|                                            | sequence(int number)                                          | 随机生成一个序列替换原整数类型的数据，该序列前两位是字符，后两位是数字                         | number表示待替换的整型数字                                                                      | 23 -> QY96                                                                                                      |                                                              |
|                                            | blur(double data)                                             | 随机生成一个double类型的数字替换原double类型数字                              | data表示待替换的double类型数据                                                                  | 234->199.17                                                                                                     |                                                              |
|                                            | character_scrambling（string  data）                            | 将String类型的字段字母打乱（汉字不适用）                                     | 输入待处理的字符串即可                                                                           | `hello world->Hwoel lrdlo`                                                                                      |                                                              |
|                                            | phone_confusion(string number)                                | 保持座机号码区号不变的情况下，对其余部分进行混淆                                    | 输入一个座机号码，类型为string                                                                    | 0571-123456->0571-678409                                                                                        |                                                              |



 
